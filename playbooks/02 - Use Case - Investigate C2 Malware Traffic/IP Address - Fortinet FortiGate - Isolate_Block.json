{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "IP Address - Fortinet FortiGate - Isolate\/Block",
    "aliasName": null,
    "tag": null,
    "description": "Isolates or blocks indicators of type 'IP Address' on the Fortinet FortiGate and marks the indicators as \"Isolated\" or \"Blocked\" depending on action taken.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "indicatorIRI",
        "alertIRI",
        "operation",
        "indicatorValue",
        "ipBlockPolicyName",
        "addressGroupName"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/7fc569b3-669e-4d7a-8587-ecfc2015add4",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/d91d96eb-d610-4e55-88a6-c65d39972b9a",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Block IP Address",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiGate",
                "config": "08141adb-c97b-41df-b6fc-2d3ff0052618",
                "params": {
                    "ip": "{{vars.indicator_value}}",
                    "vdom": "",
                    "method": "Policy Based",
                    "ip_type": "IPv4",
                    "ngfw_mode": "Profile Based",
                    "ip_group_name": "{{vars.input.params.addressGroupName}}",
                    "ip_block_policy": "{{vars.input.params.ipBlockPolicyName}}"
                },
                "version": "5.2.3",
                "connector": "fortigate-firewall",
                "operation": "block_ip",
                "mock_result": "{\n  \"data\":\n   {\n       \"newly_blocked\": [\"{{vars.indicator_value}}\"],\n       \"vdom_not_exist\": [],\n       \"already_blocked\": [],\n       \"error_with_block\": []\n   }\n}",
                "operationTitle": "Block IP Address",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "2baba92d-7b6a-421c-8d99-c54097cb2e67"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alert_iri": "{{vars.input.params.alertIRI}}",
                "indicator_iri": "{{vars.input.params.indicatorIRI}}",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "indicator_value": "{{vars.input.params.indicatorValue}}"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "cceba291-1eeb-4cda-a530-87201e55bfb4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Isolate Affected Host",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiGate",
                "config": "782410fc-89f9-453f-8750-3e8775825182",
                "params": {
                    "vdom": "",
                    "method": "Quarantine Based",
                    "ip_addresses": "{{vars.indicator_value}}",
                    "time_to_live": "12 Hour"
                },
                "version": "5.2.3",
                "connector": "fortigate-firewall",
                "operation": "block_ip",
                "mock_result": "{\n  \"data\":\n   {\n       \"newly_blocked\": [\"{{vars.indicator_value}}\"],\n       \"vdom_not_exist\": [],\n       \"already_blocked\": [],\n       \"error_with_block\": []\n   }\n}",
                "ignore_errors": false,
                "operationTitle": "Block IP Address",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "03955841-9980-4f4a-a6fd-cc89c155ae96"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark as TBD",
            "description": null,
            "arguments": {
                "when": "{{(vars.steps.Isolate_Affected_Host.data['vdom_not_exist'] | length > 0) or (vars.steps.Isolate_Affected_Host.data['error_with_block'] | length > 0) or (vars.steps.Block_IP_Address.data['error_with_block'] | length > 0)}}",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p><span class=\"fa fa-exclamation-triangle\" style=\"font-size: 15px; color: #de7a13;\" data-tomark-pass=\"\">&nbsp;<\/span>Unable to {{vars.input.params.operation}} IP Address <span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #fff;\" data-tomark-pass=\"\"><strong>{{vars.indicator_value}}<\/strong><\/span> on Fortinet FortiGate<\/p>",
                    "records": "{{vars.alert_iri}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/2d64c341-c953-4330-98eb-41968b18d28f"
                },
                "resource": {
                    "indicatorStatus": "\/api\/3\/picklists\/2f5cff61-fbff-4bb3-96be-302b78a9fb47"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.indicatorIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "bd8c7bdb-49e9-4cac-87c6-46b019cbbd41"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark IP as Blocked",
            "description": null,
            "arguments": {
                "when": "{{(vars.steps.Block_IP_Address.data['newly_blocked'] | length > 0) or (vars.steps.Block_IP_Address.data['already_blocked'] | length > 0)}}",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p><span class=\"badge badge-pill badge-danger\" style=\"background: #ba6204; color: #fff;\" data-tomark-pass=\"\"><strong>{{vars.indicator_value}}<\/strong><\/span> has been <strong>Blocked<\/strong> on <strong>Fortinet FortiGate<\/strong>.<\/p>",
                    "records": "{{vars.alert_iri}}"
                },
                "resource": {
                    "indicatorStatus": "\/api\/3\/picklists\/fa29fe48-f01e-476f-bb33-c910f5795b57"
                },
                "_showJson": true,
                "operation": "Overwrite",
                "collection": "{{vars.indicator_iri}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "2d64c341-c953-4330-98eb-41968b18d28f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark IP as Isolated",
            "description": null,
            "arguments": {
                "when": "{{(vars.steps.Isolate_Affected_Host.data['newly_blocked'] | length > 0) or (vars.steps.Isolate_Affected_Host.data['already_blocked'] | length > 0)}}",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p><span data-tomark-pass=\"\" style=\"background: #ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\"><strong>{{vars.indicator_value}}<\/strong><\/span> has been <strong>Isolated<\/strong> on <strong>Fortinet FortiGate<\/strong>.<\/p>",
                    "records": "{{vars.alert_iri}}"
                },
                "resource": {
                    "indicatorStatus": "\/api\/3\/picklists\/e4a39098-3e26-4559-a7d8-7ed6ea4d6e31"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.indicator_iri}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "5fb517e1-c0ac-419b-a1f4-6a48bfb3430d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Operation Type",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Block",
                        "step_iri": "\/api\/3\/workflow_steps\/2baba92d-7b6a-421c-8d99-c54097cb2e67",
                        "condition": "{{ vars.input.params.operation == 'Block' }}",
                        "step_name": "Block IP Address"
                    },
                    {
                        "option": "Isolate",
                        "step_iri": "\/api\/3\/workflow_steps\/03955841-9980-4f4a-a6fd-cc89c155ae96",
                        "condition": "{{ vars.input.params.operation == 'Isolate' }}",
                        "step_name": "Isolate Affected Host"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "1bdb1b3b-86c1-4ef5-987a-374525b81f16"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                    "input": {
                        "params": []
                    }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "d91d96eb-d610-4e55-88a6-c65d39972b9a"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Block IP Address -> Copy of Mark IP as Isolated",
            "targetStep": "\/api\/3\/workflow_steps\/2d64c341-c953-4330-98eb-41968b18d28f",
            "sourceStep": "\/api\/3\/workflow_steps\/2baba92d-7b6a-421c-8d99-c54097cb2e67",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "48e622b4-cb12-4bfe-b633-6c2cc1439c99"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Operation Type",
            "targetStep": "\/api\/3\/workflow_steps\/1bdb1b3b-86c1-4ef5-987a-374525b81f16",
            "sourceStep": "\/api\/3\/workflow_steps\/cceba291-1eeb-4cda-a530-87201e55bfb4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "933bf405-d235-4a68-bf3b-b7ab43e9f45b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy of Mark IP as Isolated -> Mark as TBD",
            "targetStep": "\/api\/3\/workflow_steps\/bd8c7bdb-49e9-4cac-87c6-46b019cbbd41",
            "sourceStep": "\/api\/3\/workflow_steps\/2d64c341-c953-4330-98eb-41968b18d28f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b9484923-7034-444d-ad16-b0c75ae336f1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Isolate Affected Host -> Mark IP as Isolated",
            "targetStep": "\/api\/3\/workflow_steps\/5fb517e1-c0ac-419b-a1f4-6a48bfb3430d",
            "sourceStep": "\/api\/3\/workflow_steps\/03955841-9980-4f4a-a6fd-cc89c155ae96",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7526d224-6e8a-482b-be5b-913cfd85044b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Mark IP as Isolated -> Mark as TBD",
            "targetStep": "\/api\/3\/workflow_steps\/bd8c7bdb-49e9-4cac-87c6-46b019cbbd41",
            "sourceStep": "\/api\/3\/workflow_steps\/5fb517e1-c0ac-419b-a1f4-6a48bfb3430d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0b75297f-09d9-47f4-90aa-15034a9e9e81"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Operation Type -> Block IP Address",
            "targetStep": "\/api\/3\/workflow_steps\/2baba92d-7b6a-421c-8d99-c54097cb2e67",
            "sourceStep": "\/api\/3\/workflow_steps\/1bdb1b3b-86c1-4ef5-987a-374525b81f16",
            "label": "Block",
            "isExecuted": false,
            "group": null,
            "uuid": "9271dffa-942a-4e90-91eb-a84a93930081"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Operation Type -> Isolate Affected Host",
            "targetStep": "\/api\/3\/workflow_steps\/03955841-9980-4f4a-a6fd-cc89c155ae96",
            "sourceStep": "\/api\/3\/workflow_steps\/1bdb1b3b-86c1-4ef5-987a-374525b81f16",
            "label": "Isolate",
            "isExecuted": false,
            "group": null,
            "uuid": "c45e9489-e086-401d-a26b-4536f95ba98a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/cceba291-1eeb-4cda-a530-87201e55bfb4",
            "sourceStep": "\/api\/3\/workflow_steps\/d91d96eb-d610-4e55-88a6-c65d39972b9a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9375bae0-ac2c-4656-917f-ae38625e9b8b"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "6a62c10a-2168-48c3-a435-4b00988a1f2a",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Referenced"
    ]
}